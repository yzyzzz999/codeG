# CodeG - ä¼ä¸šçº§ä»£ç è´¨é‡æ²»ç† Agent

åŸºäºå¤§è¯­è¨€æ¨¡å‹å’Œ Agent æ¶æ„çš„æ™ºèƒ½ä»£ç å®¡æŸ¥ç³»ç»Ÿï¼Œæ”¯æŒ Bug æ£€æµ‹ã€å®‰å…¨å®¡è®¡ã€æ€§èƒ½ä¼˜åŒ–å»ºè®®ã€‚

## æ ¸å¿ƒèƒ½åŠ›

- **è¯­ä¹‰çº§ä»£ç ç†è§£**ï¼šåŸºäº CodeBERT/CodeT5 çš„ä»£ç è¡¨å¾å­¦ä¹ 
- **æ™ºèƒ½ Bug æ£€æµ‹**ï¼šå¾®è°ƒæ¨¡å‹è¯†åˆ«æ½œåœ¨ç¼ºé™·ï¼ˆNPEã€èµ„æºæ³„æ¼ã€å¹¶å‘é—®é¢˜ç­‰ï¼‰
- **ReAct Agent æ¶æ„**ï¼šç†è§£é—®é¢˜ â†’ æ£€ç´¢ä¸Šä¸‹æ–‡ â†’ åˆ†ææ¨ç† â†’ ç”Ÿæˆä¿®å¤å»ºè®®
- **GraphRAG å¢å¼º**ï¼šæ–¹æ³•è°ƒç”¨é“¾åˆ†æï¼Œè·¨æ–‡ä»¶ç†è§£
- **ç”Ÿäº§çº§éƒ¨ç½²**ï¼šFastAPI + Docker + K8sï¼Œæ”¯æŒé«˜å¹¶å‘

## é‡åŒ–æŒ‡æ ‡ç›®æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | éªŒè¯æ–¹å¼ |
|------|------|----------|
| Bug æ£€å‡ºç‡ | &gt;75% | Defects4J æ•°æ®é›† |
| è¯¯æŠ¥ç‡ | &lt;20% | äººå·¥æ ‡æ³¨éªŒè¯ |
| å¹³å‡å“åº”æ—¶é—´ | &lt;3s | P99 |
| å¹¶å‘æ”¯æŒ | 100 QPS | å‹æµ‹ |
| ä»£ç æ£€ç´¢å‡†ç¡®ç‡ | &gt;85% | Top-5 Recall |

## æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Python 3.10+
- **æ¨¡å‹**: CodeT5, CodeBERT, è‡ªç ”å¾®è°ƒæ¨¡å‹
- **Agent**: åŸç”Ÿ ReAct å®ç° + LangChain å·¥å…·å°è£…
- **å‘é‡æ•°æ®åº“**: Milvus
- **å›¾æ•°æ®åº“**: Neo4j (GraphRAG)
- **API æ¡†æ¶**: FastAPI
- **éƒ¨ç½²**: Docker, Kubernetes
- **ç›‘æ§**: Prometheus + Grafana

## é¡¹ç›®ç»“æ„


```
CodeG/
â”œâ”€â”€ data/                   # æ•°æ®é›†å’Œé¢„å¤„ç†
â”‚   â”œâ”€â”€ raw/               # åŸå§‹æ•°æ®
â”‚   â”œâ”€â”€ processed/         # å¤„ç†åæ•°æ®
â”‚   â””â”€â”€ defects4j/         # Defects4J æ•°æ®é›†
â”‚       â”œâ”€â”€ real/          # çœŸå®æ•°æ® (buggy/fixed é…å¯¹)
â”‚       â””â”€â”€ processed/     # å¤„ç†åçš„è®­ç»ƒæ•°æ®
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ parser/            # Java ä»£ç è§£æ (Tree-sitter)
â”‚   â”œâ”€â”€ embedding/         # ä»£ç å‘é‡åŒ–
â”‚   â”œâ”€â”€ models/            # æ¨¡å‹å®šä¹‰å’Œå¾®è°ƒ
â”‚   â”‚   â”œâ”€â”€ train_lora.py      # LoRA è®­ç»ƒè„šæœ¬
â”‚   â”‚   â”œâ”€â”€ evaluate.py        # æ¨¡å‹è¯„ä¼°
â”‚   â”‚   â””â”€â”€ predict.py         # æ¨¡å‹æ¨ç†
â”‚   â”œâ”€â”€ agent/             # ReAct Agent æ ¸å¿ƒ
â”‚   â”œâ”€â”€ rag/               # RAG ç³»ç»Ÿ (å‘é‡æ£€ç´¢ + GraphRAG)
â”‚   â”œâ”€â”€ api/               # FastAPI æœåŠ¡
â”‚   â””â”€â”€ data/              # æ•°æ®å¤„ç†
â”‚       â”œâ”€â”€ mock_defects4j.py      # æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆ
â”‚       â”œâ”€â”€ process_defects4j.py   # Defects4J å¤„ç†å™¨
â”‚       â”œâ”€â”€ dataset.py             # PyTorch Dataset
â”‚       â””â”€â”€ data_augmentation.py   # æ•°æ®å¢å¼º
â”œâ”€â”€ configs/               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ scripts/               # è®­ç»ƒå’Œéƒ¨ç½²è„šæœ¬
â”œâ”€â”€ tests/                 # å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
â”œâ”€â”€ docs/                  # æ–‡æ¡£
â”œâ”€â”€ docker/                # Docker é…ç½®
â””â”€â”€ notebooks/             # å®éªŒå’Œåˆ†æ notebook
```


## å¼€å‘é˜¶æ®µ

### âœ… Phase 1: é¡¹ç›®æ­å»ºä¸åŸºç¡€å‡†å¤‡
- [x] é¡¹ç›®ç»“æ„æ­å»º
- [x] README å’Œæ–‡æ¡£
- [x] docker-compose (Milvus + Neo4j)
- [x] Defects4J æ•°æ®åŠ è½½å™¨

### âœ… Phase 2: ä»£ç è§£æä¸å‘é‡åŒ–
- [x] Java AST è§£æ (Tree-sitter)
- [x] æ–¹æ³•æå–å™¨
- [x] CodeBERT å‘é‡åŒ–
- [x] Milvus å‘é‡å­˜å‚¨ä¸æ£€ç´¢
- [x] é›†æˆæµ‹è¯•é€šè¿‡

### ğŸ”„ Phase 3: Bug æ£€æµ‹æ¨¡å‹å¾®è°ƒ (è¿›è¡Œä¸­)
- [x] Defects4J çœŸå®æ•°æ®æ£€å‡º (18 ä¸ªæ ·æœ¬)
- [x] æ•°æ®å¤„ç†å™¨ (buggy/fixed é…å¯¹)
- [x] PyTorch Dataset ç±»
- [x] æ•°æ®åˆ’åˆ† (train/val/test)
- [x] LoRA å¾®è°ƒè®­ç»ƒè„šæœ¬
- [x] æ¨¡å‹è¯„ä¼°è„šæœ¬
- [x] æ¨¡å‹æ¨ç†è„šæœ¬
- [x] æ•°æ®å¢å¼ºè„šæœ¬
- [ ] æ¨¡å‹è®­ç»ƒ (ç­‰å¾…æ¨¡å‹ä¸‹è½½)
- [ ] è¯„ä¼°ä¸è°ƒä¼˜

### â¬œ Phase 4: Agent æ¡†æ¶å®ç°
- [ ] ReAct æ¨¡å¼å®ç°
- [ ] å·¥å…·è°ƒç”¨ (ä»£ç æ£€ç´¢ã€é™æ€åˆ†æ)
- [ ] MCP åè®®æ¥å…¥

### â¬œ Phase 5: RAG ä¸ GraphRAG
- [ ] GraphRAG æ–¹æ³•è°ƒç”¨é“¾åˆ†æ
- [ ] æ··åˆæ£€ç´¢ (BM25 + å‘é‡ + é‡æ’)

### â¬œ Phase 6: éƒ¨ç½²ä¸ä¼˜åŒ–
- [ ] FastAPI æœåŠ¡åŒ–
- [ ] TensorRT æ¨ç†ä¼˜åŒ–
- [ ] Docker + K8s éƒ¨ç½²

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Python 3.10+
- CUDA 11.8+
- Docker & docker-compose

### å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### å¯åŠ¨åŸºç¡€è®¾æ–½
```bash
docker-compose up -d
```

### å¤„ç†æ•°æ®
```bash
# æ£€å‡º Defects4J æ•°æ®
cd ~/defects4j
./init.sh

# å¤„ç†æˆè®­ç»ƒæ ¼å¼
python src/data/process_defects4j.py

# æ•°æ®å¢å¼º (å¯é€‰)
python src/data/data_augmentation.py
```
### è®­ç»ƒæ¨¡å‹
```bash
python src/models/train_lora.py
```
### è¯„ä¼°æ¨¡å‹
```bash
python src/models/evaluate.py
```
### æ¨ç†æµ‹è¯•
```bash
python src/models/predict.py
```
### æœ€è¿‘æ›´æ–°
- 2026-02-26: Phase 3 è¿›è¡Œä¸­ï¼Œå®Œæˆæ•°æ®å¤„ç†å’Œè®­ç»ƒè„šæœ¬ï¼Œäº‘æœåŠ¡å™¨ç¯å¢ƒæ­å»ºå®Œæˆ
### å¾…åŠäº‹é¡¹
- ç²¾æ’åŠŸèƒ½ - å·²è®°ä¸‹ï¼ŒPhase 3 åå†åš
- ç»†åˆ†ç±»åˆ«æ£€æµ‹ - å·²è®°ä¸‹ï¼Œåç»­å®ç°å¤šæ ‡ç­¾åˆ†ç±»
- Prometheus ç›‘æ§ - docker-compose ä¸­æœ‰é…ç½®ï¼Œæš‚æœªå¯ç”¨
### License
MIT
